input_features:
  - name: image_path
    type: image
    preprocessing:
      num_processes: 4
    encoder: stacked_cnn
    conv_layers:
      - num_filters: 32
        filter_size: 3
        pool_size: 2
        pool_stride: 2
      - num_filters: 64
        filter_size: 3
        pool_size: 2
        pool_stride: 2
        dropout: 0.4
    fc_layers:
      - output_size: 128
        dropout: 0.4

output_features:
  - name: label
    type: category

trainer:
  epochs: 5

hyperopt:
  goal: maximize
  output_feature: label
  metric: accuracy
  split: validation
  parameters:
    training.learning_rate:
      space: loguniform
      lower: 0.0001
      upper: 0.1
    training.optimizer.type:
      space: choice
      categories: [sgd, adam, adagrad]
  search_alg:
    type: variant_generator
  executor:
    type: ray
    scheduler:
      type: async_hyperband
      time_attr: training_iteration
      reduction_factor: 4    